# Chap 10. JS前端開發工具鏈

## Node.js

Node.js(也稱node、nodejs)是一個JavaScript運行環境。Node.js誕生於2009年，其誕生之初就沒有歷史包袱，幾年來發展快速，至今仍在不斷更新完善。通常認為，JavaScript的定位是作為瀏覽器腳本語言，Node.js則顛覆了這個定位，將JavaScript變為一個可在伺服器上運行的全棧語言。基於Chrome V8解釋引擎，使用Node.js可方便地搭建響應速度快、易於擴展的網絡應用。Node.js的核心優勢是使用**事件驅動**和**非阻塞I/O模型**，使其輕量且高效，非常適合在**分布式設備上運行I/O密集型的實時應用**。

Node.js適用於後端伺服器開發的，而React是前端框架，那麼兩者有何關聯？

在Node.js未出現以前，JavaScript只能運行在瀏覽器中，在前端開發中調試時，測試手段單一，一般也只能做一些簡單的工作，要實現模組化更是困難。而Node.js的出現將JavaScript解放出來，也將以JavaScript為基礎的前端解放出來，就有了包管理器、構建工具、打包工具的出現。這些工具不是運行在瀏覽器中，而是運行在Node.js環境中，只有最終生成的代碼在瀏覽器中運行。

## Node.js模組和包

### 模組

在NPM中一個模組就是一個js腳本文件，在這個腳本文件可以聲明導出一些由其他模組導入變數、函式、對象等。

### 包

一個包通常就是一個文件夾，但在這個文件夾下按包的格式約定包含了一些特殊的文件和文件夾。具體來說，一個包至少要包含包的描述文件package.json和具體的模組文件>

package.json以json的格式保存了包的描述、配置及依賴信息。

完整的package.json包含三部分內容：

1. 包的基本屬性
2. 與用戶相關的屬性
3. 包中文件和模組的描述

下面將對基礎配置項進行簡要說明

- name：必選項，表示模組名稱。命名時不能包含js、node和url中需要轉譯的字符，不能以.或_開頭
- version：必選項，表示模組的版本號。版本號格式為“主版本號(Major)”.“副版本號(Minor)”.補丁版本號(Patch)
- main：必選項，模組入口文件相對路徑(相對於模組根目錄)
- description：可選項，表示模組功能描述
- keywords：可選項，陣列類型，表示模組的關鍵字
- author：可選項，表示發起人信息
- engines：可選項，所依賴的Node.js版本
- repository：可選項，源碼託管地址
- scripts：可選項，自定義包含在文件中的可執行命令，使用時輸入`npm run <script>`即可啟動對應的命令。這個選項是常用的重要選項
- dependencies和devDependencies：可選項，用於配置模組的生產環境依賴包和開發環境依賴包

## npm模組管理器

npm是Node.js的包管理工具，主要針對代碼包和依賴的下載、使用、更新、卸載、上傳和部署提供了整套解決方案，是當今JavaScript開發必不可少的工具。npm的官網地址是npmjs.org。隨著前端和Node.js的發展和流行，目前，npm社區軟件包的數量已經超越C、C++，已然成為全球最大的代碼工廠。

npm常見的使用場景有以下幾種：

- 從npm server下載第三方包到本地使用，如react-dom
- 從npm server下載第三方包並安裝為可執行的命令行程序供本地使用，如babel
- 將自己編寫的包或命令行程序上傳到npm server供他人下載使用

## ES 6 規範簡介

## ESLint工具

## Babel工具

## webpack打包工具使用與技巧

### 前端模組化與webpack介紹

模組化目的是使代碼可以重用，模組化在任何開發中都是必不可少的。前端的模組化是Node.js帶來的新產物，若干年前，前端模組化的需求並不是很強烈，因為在瀏覽器裡運行的邏輯都比較簡單。隨著Node.js出現，JavaScript開始在後端發揮作用，為了代碼重用，模組化就變得不可或缺。隨著前端快速發展，前端業務越來越複雜，模組化的需求開始出現。

為了實現模組化，出現了用於JavaScript模組管理的兩大流行規範：CommonJS和AMD。前者定義的是模組的同步加載，主要用於Node.js。同步加載在前端會導致整個頁面等待，對前端並不適用，便出現了AMD。AMD採用異步加載方式，透過RequireJS等工具適用於前端。以RequireJS為例，這是一種在線“編譯”模組的方案，相當於在瀏覽器中先加載一個AMD解釋器，使瀏覽器認識define、exports、module等相關命令，來實現模組化。後來ES 6提供了對模組的原生支持，它的目標是創建一種CommonJS和AMD使用者都願意接受的方式，既擁有簡潔的語法，又支持異步加載和配置模組加載。

而目前更通用的是browserify、webpack等技術，是一個預編譯模組的方案。而這個方案更加智能，因為它是在發佈前預編譯好的，不需要在瀏覽器中加載解釋器。另外，直接寫AMD或ES 6的模組化代碼，它都能編譯成瀏覽器識別的JavaScript代碼。甚至CommonJS規範的模組化，browserify、webpack也可以轉換成瀏覽器使用的形式。webpack相當於加強版browserify，誕生伊始，瞄準的就是大型單頁應用，而且對其React支持是最好的。

webpack是一個供瀏覽器環境使用的模組打包工具。webpack將項目用到的一切靜態資源都視為模組，模組之間可以互相依賴，webpack對它們進行統一的管理及打包發布。

![What is webpack](http://i.imgur.com/hMOSBxi.png)

webpack的作用是對項目中的靜態資源進行統一管理，為項目的發佈提供最優的打包和部署方案，可以把應用中的js、css、圖片等資源集中打成一個或多個包文件。它具備編譯打包css、預處理css、編譯js和處理圖片等許多功能，支持AMD和CommonJS規範，以及多種系統模組，現在已成為前端打包的主流工具。

webpack主要特性：

1. 同時支持CommonJS和AMD模組
2. 串聯式模組加載器及插件機制，具有更好的靈活性和擴展性，例如對CoffeeScript、ES6的支持
3. 可以基於配置或智能分析打包成多個文件，實現分別滿足公共模組和按需加載的需要
4. 支持對css、圖片等資源進行打包，無須依靠grunt或gulp等構建工具，簡化工程配置
5. 開發時在內存中完成打包，性能更高，完全可以支持開發過程的實時打包需求
6. 對sourcemap有很好的支持，易於調試
